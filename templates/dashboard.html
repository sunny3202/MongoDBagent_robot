<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè≠ AGV Ïö¥ÏòÅ ÏÑºÌÑ∞ ÎåÄÏãúÎ≥¥Îìú</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f1419;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: auto;
        }

        .dashboard-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        /* Ïã§ÏãúÍ∞Ñ Ïö¥ÏòÅ ÌòÑÌô©Ìåê */
        .operation-overview {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .real-time-map {
            background: linear-gradient(135deg, #1f2937, #374151);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .map-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .map-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #60a5fa;
        }

        .map-status {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 500;
        }

        .status-active { background: #065f46; color: #10b981; }
        .status-warning { background: #92400e; color: #f59e0b; }
        .status-error { background: #991b1b; color: #f87171; }

        /* Í≥µÏû• Î†àÏù¥ÏïÑÏõÉ Îßµ */
        .factory-layout {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .zone {
            background: #374151;
            border: 2px solid #4b5563;
            border-radius: 10px;
            padding: 15px;
            min-height: 120px;
            position: relative;
            transition: all 0.3s ease;
        }

        .zone:hover {
            border-color: #60a5fa;
            transform: translateY(-2px);
        }

        .zone-header {
            font-weight: 600;
            color: #d1d5db;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .robot-in-zone {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid #3b82f6;
            border-radius: 6px;
            padding: 6px 8px;
            margin-bottom: 5px;
            font-size: 0.8em;
        }

        .robot-status-icon {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-working { background: #10b981; }
        .status-moving { background: #3b82f6; }
        .status-idle { background: #f59e0b; }
        .status-error { background: #ef4444; }
        .status-charging { background: #8b5cf6; }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .zone-empty {
            color: #6b7280;
            font-style: italic;
            font-size: 0.8em;
        }

        /* Ïö¥ÏòÅ ÌÜµÍ≥Ñ ÏÇ¨Ïù¥ÎìúÎ∞î */
        .operation-stats {
            background: linear-gradient(135deg, #1f2937, #374151);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .stats-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 20px;
            text-align: center;
        }

        .stat-group {
            margin-bottom: 25px;
        }

        .stat-group h4 {
            color: #d1d5db;
            margin-bottom: 12px;
            font-size: 1em;
            border-bottom: 1px solid #4b5563;
            padding-bottom: 5px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #374151;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #9ca3af;
            font-size: 0.9em;
        }

        .stat-value {
            font-weight: 600;
            font-size: 1.1em;
        }

        .stat-value.good { color: #10b981; }
        .stat-value.warning { color: #f59e0b; }
        .stat-value.danger { color: #ef4444; }

        /* Ïã§ÏãúÍ∞Ñ ÏûëÏóÖ ÌòÑÌô© */
        .work-status-section {
            background: linear-gradient(135deg, #1f2937, #374151);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .work-status-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .work-status-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #60a5fa;
        }

        .work-controls {
            display: flex;
            gap: 10px;
        }

        .work-progress-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 15px;
        }

        .work-item {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid #374151;
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s ease;
        }

        .work-item:hover {
            border-color: #60a5fa;
            background: rgba(59, 130, 246, 0.1);
        }

        .work-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .robot-id {
            font-weight: 600;
            color: #60a5fa;
        }

        .work-status {
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 500;
        }

        .work-status.working { background: #065f46; color: #10b981; }
        .work-status.moving { background: #1e3a8a; color: #60a5fa; }
        .work-status.waiting { background: #92400e; color: #f59e0b; }
        .work-status.error { background: #991b1b; color: #f87171; }

        .work-details {
            color: #d1d5db;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .progress-bar {
            background: #374151;
            border-radius: 10px;
            height: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #60a5fa);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .work-meta {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            font-size: 0.8em;
            color: #9ca3af;
        }

        /* Ï†úÏñ¥ Ìå®ÎÑê */
        .control-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .control-card {
            background: linear-gradient(135deg, #1f2937, #374151);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .control-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 20px;
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-start {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
        }

        .btn-stop {
            background: linear-gradient(135deg, #dc2626, #ef4444);
            color: white;
        }

        .btn-emergency {
            background: linear-gradient(135deg, #991b1b, #dc2626);
            color: white;
            animation: pulse-red 2s infinite;
        }

        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Íµ¨Ïó≠Î≥Ñ Ìö®Ïú®ÏÑ± */
        .zone-efficiency {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .efficiency-item {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid #374151;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .efficiency-zone {
            font-weight: 600;
            color: #60a5fa;
            margin-bottom: 8px;
        }

        .efficiency-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .efficiency-status {
            font-size: 0.8em;
            padding: 3px 8px;
            border-radius: 10px;
        }

        .efficiency-good { color: #10b981; background: rgba(16, 185, 129, 0.1); }
        .efficiency-warning { color: #f59e0b; background: rgba(245, 158, 11, 0.1); }
        .efficiency-poor { color: #ef4444; background: rgba(239, 68, 68, 0.1); }

        /* ÏïåÎ¶º ÏÑºÌÑ∞ */
        .alerts-section {
            background: linear-gradient(135deg, #1f2937, #374151);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .alerts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .alerts-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #60a5fa;
        }

        .alert-count {
            background: #dc2626;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .alerts-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .alert-item {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(239, 68, 68, 0.05);
            border: 1px solid #dc2626;
            border-radius: 8px;
            padding: 12px;
        }

        .alert-icon {
            font-size: 1.2em;
        }

        .alert-content {
            flex: 1;
        }

        .alert-message {
            color: #f87171;
            font-weight: 500;
            margin-bottom: 3px;
        }

        .alert-time {
            color: #9ca3af;
            font-size: 0.8em;
        }

        .alert-priority {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7em;
            font-weight: 600;
        }

        .priority-high { background: #991b1b; color: #fecaca; }
        .priority-medium { background: #92400e; color: #fed7aa; }
        .priority-low { background: #365314; color: #bbf7d0; }

        /* Î°úÍ∑∏ ÏÑπÏÖò */
        .logs-section {
            background: linear-gradient(135deg, #1f2937, #374151);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .logs-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .logs-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #60a5fa;
        }

        .log-container {
            background: #111827;
            border-radius: 10px;
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 5px 0;
        }

        .log-info { color: #60a5fa; }
        .log-success { color: #10b981; }
        .log-warning { color: #f59e0b; }
        .log-error { color: #ef4444; }

        /* Î∞òÏùëÌòï ÎîîÏûêÏù∏ */
        @media (max-width: 1200px) {
            .operation-overview {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .factory-layout {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .work-progress-list {
                grid-template-columns: 1fr;
            }
            
            .zone-efficiency {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Î°úÎî© Ïï†ÎãàÎ©îÏù¥ÏÖò */
        .loading {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            z-index: 1000;
        }

        .spinner {
            border: 4px solid #374151;
            border-top: 4px solid #60a5fa;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* MongoDB ÏÑ§Ï†ï Ïä§ÌÉÄÏùº */
        .mongodb-config-section {
            space-y: 20px;
        }

        .connection-status {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .connection-status.connected {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
        }

        .connection-status.disconnected {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }

        .status-indicator {
            font-size: 1.2em;
        }

        .mongo-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .mongo-actions .btn {
            flex: 1;
            min-width: 120px;
        }

        .mongo-test-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid;
            animation: slideIn 0.3s ease;
        }

        .mongo-test-result.success {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: #10b981;
            color: #10b981;
        }

        .mongo-test-result.error {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: #ef4444;
            color: #ef4444;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Í∞úÎ≥Ñ Î°úÎ¥á Ï†úÏñ¥ ÌÖåÏù¥Î∏î Ïä§ÌÉÄÏùº */
        .robot-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(59, 130, 246, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        .robot-table th {
            background: #374151;
            color: #d1d5db;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #4b5563;
        }

        .robot-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #374151;
            color: #d1d5db;
        }

        .robot-table tbody tr:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .robot-controls-cell {
            display: flex;
            gap: 5px;
        }

        .robot-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.2s ease;
        }

        .robot-btn.start { 
            background: #059669; 
            color: white; 
        }

        .robot-btn.stop { 
            background: #dc2626; 
            color: white; 
        }

        .robot-btn.reset { 
            background: #6b7280; 
            color: white; 
        }

        .robot-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .robot-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ÏÑ§Ï†ï Í∑∏Î¶¨Îìú Ïä§ÌÉÄÏùº */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .setting-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .setting-item label {
            font-weight: 600;
            color: #d1d5db;
            font-size: 0.9em;
        }

        .setting-item input,
        .setting-item select {
            padding: 10px;
            border: 2px solid #4b5563;
            border-radius: 8px;
            background: #374151;
            color: #ffffff;
            font-size: 1em;
        }

        .setting-item input:focus,
        .setting-item select:focus {
            outline: none;
            border-color: #60a5fa;
            box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.1);
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Ìó§Îçî -->
        <div class="header">
            <h1>üè≠ AGV Ïö¥ÏòÅ ÏÑºÌÑ∞ ÎåÄÏãúÎ≥¥Îìú</h1>
            <p>Ïã§ÏãúÍ∞Ñ 30ÎåÄ Î°úÎ¥á Î™®ÎãàÌÑ∞ÎßÅ Î∞è Ï†úÏñ¥ ÏãúÏä§ÌÖú</p>
        </div>

        <!-- Ïã§ÏãúÍ∞Ñ Ïö¥ÏòÅ ÌòÑÌô©Ìåê -->
        <div class="operation-overview">
            <!-- Ïã§ÏãúÍ∞Ñ Î°úÎ¥á ÏúÑÏπò Îßµ -->
            <div class="real-time-map">
                <div class="map-header">
                    <h2 class="map-title">üó∫Ô∏è Ïã§ÏãúÍ∞Ñ Î°úÎ¥á ÏúÑÏπò Îßµ</h2>
                    <div class="map-status">
                        <span class="status-badge status-active" id="activeRobotsStatus">Ï†ïÏÉÅ: 25ÎåÄ</span>
                        <span class="status-badge status-warning" id="warningRobotsStatus">Ï£ºÏùò: 3ÎåÄ</span>
                        <span class="status-badge status-error" id="errorRobotsStatus">Î¨∏Ï†ú: 2ÎåÄ</span>
                    </div>
                </div>
                
                <!-- Í≥µÏû• Î†àÏù¥ÏïÑÏõÉ -->
                <div class="factory-layout" id="factoryLayout">
                    <!-- H3 Íµ¨Ïó≠ -->
                    <div class="zone" data-zone="H3">
                        <div class="zone-header">üè≠ H3 Íµ¨Ïó≠ (17L-15L)</div>
                        <div id="zone-H3-robots">
                            <div class="zone-empty">Î°úÎ¥á ÏúÑÏπò Î°úÎî© Ï§ë...</div>
                        </div>
                    </div>
                    
                    <!-- K2 Íµ¨Ïó≠ -->
                    <div class="zone" data-zone="K2">
                        <div class="zone-header">üè≠ K2 Íµ¨Ïó≠ (15L-13L)</div>
                        <div id="zone-K2-robots">
                            <div class="zone-empty">Î°úÎ¥á ÏúÑÏπò Î°úÎî© Ï§ë...</div>
                        </div>
                    </div>
                    
                    <!-- P1 Íµ¨Ïó≠ -->
                    <div class="zone" data-zone="P1">
                        <div class="zone-header">üè≠ P1 Íµ¨Ïó≠ (12L-10L)</div>
                        <div id="zone-P1-robots">
                            <div class="zone-empty">Î°úÎ¥á ÏúÑÏπò Î°úÎî© Ï§ë...</div>
                        </div>
                    </div>
                    
                    <!-- Ï∂©Ï†ÑÏÜå -->
                    <div class="zone" data-zone="CHARGE">
                        <div class="zone-header">üîã Ï∂©Ï†ÑÏÜå</div>
                        <div id="zone-CHARGE-robots">
                            <div class="zone-empty">Ï∂©Ï†Ñ Ï§ëÏù∏ Î°úÎ¥á ÏóÜÏùå</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ïö¥ÏòÅ ÌÜµÍ≥Ñ ÏÇ¨Ïù¥ÎìúÎ∞î -->
            <div class="operation-stats">
                <h3 class="stats-title">üìä Ïã§ÏãúÍ∞Ñ Ïö¥ÏòÅ ÌÜµÍ≥Ñ</h3>
                
                <div class="stat-group">
                    <h4>üéØ Í∏àÏùº ÏÑ±Í≥º</h4>
                    <div class="stat-item">
                        <span class="stat-label">ÏôÑÎ£å ÎØ∏ÏÖò</span>
                        <span class="stat-value good" id="todayMissions">847</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Î™©Ìëú Îã¨ÏÑ±Î•†</span>
                        <span class="stat-value good" id="achievementRate">94%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ÌèâÍ∑† Ï≤òÎ¶¨ ÏãúÍ∞Ñ</span>
                        <span class="stat-value" id="avgProcessTime">4.2Î∂Ñ</span>
                    </div>
                </div>

                <div class="stat-group">
                    <h4>‚ö° Ïã§ÏãúÍ∞Ñ ÏÉÅÌÉú</h4>
                    <div class="stat-item">
                        <span class="stat-label">ÏûëÏóÖ Ï§ë</span>
                        <span class="stat-value good" id="workingRobots">18ÎåÄ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Ïù¥Îèô Ï§ë</span>
                        <span class="stat-value" id="movingRobots">7ÎåÄ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">ÎåÄÍ∏∞/Ï∂©Ï†Ñ</span>
                        <span class="stat-value warning" id="idleRobots">3ÎåÄ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Î¨∏Ï†ú ÏÉÅÌô©</span>
                        <span class="stat-value danger" id="problemRobots">2ÎåÄ</span>
                    </div>
                </div>

                <div class="stat-group">
                    <h4>üîã Î∞∞ÌÑ∞Î¶¨ ÌòÑÌô©</h4>
                    <div class="stat-item">
                        <span class="stat-label">ÌèâÍ∑† Î∞∞ÌÑ∞Î¶¨</span>
                        <span class="stat-value good" id="avgBattery">78%</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Î∂ÄÏ°± Í≤ΩÍ≥†</span>
                        <span class="stat-value warning" id="lowBatteryRobots">3ÎåÄ</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Ï∂©Ï†Ñ ÌïÑÏöî</span>
                        <span class="stat-value danger" id="chargingNeeded">1ÎåÄ</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ïã§ÏãúÍ∞Ñ ÏûëÏóÖ ÌòÑÌô© -->
        <div class="work-status-section">
            <div class="work-status-header">
                <h3 class="work-status-title">üöÄ Ïã§ÏãúÍ∞Ñ ÏûëÏóÖ ÌòÑÌô©</h3>
                <div class="work-controls">
                    <button class="btn btn-start" id="startAllBtn">‚ñ∂Ô∏è Ï†ÑÏ≤¥ ÏãúÏûë</button>
                    <button class="btn btn-stop" id="stopAllBtn">‚èπÔ∏è Ï†ÑÏ≤¥ Ï†ïÏßÄ</button>
                    <button class="btn btn-emergency" id="emergencyBtn">üö® ÎπÑÏÉÅ Ï†ïÏßÄ</button>
                </div>
            </div>
            
            <div class="work-progress-list" id="workProgressList">
                <!-- Ïã§ÏãúÍ∞Ñ ÏûëÏóÖ ÏßÑÌñâ ÏÉÅÌô©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
            </div>
        </div>

        <!-- Ï†úÏñ¥ Ìå®ÎÑê -->
        <div class="control-panel">
            <!-- ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ Ï†úÏñ¥ -->
            <div class="control-card">
                <h3 class="control-title">üéÆ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ Ï†úÏñ¥</h3>
                <div class="control-buttons">
                    <button class="btn btn-start" id="startSimBtn">‚ñ∂Ô∏è ÏãúÎÆ¨Î†àÏù¥ÏÖò ÏãúÏûë</button>
                    <button class="btn btn-stop" id="stopSimBtn">‚èπÔ∏è ÏãúÎÆ¨Î†àÏù¥ÏÖò Ï†ïÏßÄ</button>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏÉÅÌÉú</span>
                    <span class="stat-value" id="simulatorStatus">Ï†ïÏßÄÎê®</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Ïã§Ìñâ ÏãúÍ∞Ñ</span>
                    <span class="stat-value" id="simulatorUptime">0Ï¥à</span>
                </div>
            </div>

            <!-- Íµ¨Ïó≠Î≥Ñ Ìö®Ïú®ÏÑ± -->
            <div class="control-card">
                <h3 class="control-title">üìà Íµ¨Ïó≠Î≥Ñ Ìö®Ïú®ÏÑ±</h3>
                <div class="zone-efficiency" id="zoneEfficiency">
                    <div class="efficiency-item">
                        <div class="efficiency-zone">H3 Íµ¨Ïó≠</div>
                        <div class="efficiency-value good">102%</div>
                        <div class="efficiency-status efficiency-good">Ï†ïÏÉÅ</div>
                    </div>
                    <div class="efficiency-item">
                        <div class="efficiency-zone">K2 Íµ¨Ïó≠</div>
                        <div class="efficiency-value warning">87%</div>
                        <div class="efficiency-status efficiency-warning">ÏßÄÏó∞</div>
                    </div>
                    <div class="efficiency-item">
                        <div class="efficiency-zone">P1 Íµ¨Ïó≠</div>
                        <div class="efficiency-value danger">45%</div>
                        <div class="efficiency-status efficiency-poor">Î¨∏Ï†ú</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ÏïåÎ¶º ÏÑºÌÑ∞ -->
        <div class="alerts-section">
            <div class="alerts-header">
                <h3 class="alerts-title">üö® Ïã§ÏãúÍ∞Ñ ÏïåÎ¶º</h3>
                <span class="alert-count" id="totalAlerts">5</span>
            </div>
            
            <div class="alerts-list" id="alertsList">
                <div class="alert-item">
                    <span class="alert-icon">üîã</span>
                    <div class="alert-content">
                        <div class="alert-message">AGV-003 Î∞∞ÌÑ∞Î¶¨ Î∂ÄÏ°± (25%)</div>
                        <div class="alert-time">2Î∂Ñ Ï†Ñ</div>
                    </div>
                    <span class="alert-priority priority-high">Í∏¥Í∏â</span>
                </div>
                
                <div class="alert-item">
                    <span class="alert-icon">üì°</span>
                    <div class="alert-content">
                        <div class="alert-message">AGV-015 ÌÜµÏã† ÎÅäÍπÄ (ÏúÑÏπò: H2-08L)</div>
                        <div class="alert-time">5Î∂Ñ Ï†Ñ</div>
                    </div>
                    <span class="alert-priority priority-high">Í∏¥Í∏â</span>
                </div>
                
                <div class="alert-item">
                    <span class="alert-icon">‚ö†Ô∏è</span>
                    <div class="alert-content">
                        <div class="alert-message">AGV-029 Ïû•Ïï†Î¨º Í∞êÏßÄ Ï†ïÏßÄ (K1-14L)</div>
                        <div class="alert-time">8Î∂Ñ Ï†Ñ</div>
                    </div>
                    <span class="alert-priority priority-medium">Ï£ºÏùò</span>
                </div>
            </div>
        </div>

        <!-- Í∞úÎ≥Ñ Î°úÎ¥á Ï†úÏñ¥ Î∞è Îç∞Ïù¥ÌÑ∞ ÏûÖÎ†• -->
        <div class="control-panel">
            <div class="control-card">
                <h3 class="control-title">ü§ñ Í∞úÎ≥Ñ Î°úÎ¥á Ï†úÏñ¥</h3>
                <div class="robot-table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="robot-table" id="individualRobotTable">
                        <thead>
                            <tr>
                                <th>Î°úÎ¥á ID</th>
                                <th>ÏÉÅÌÉú</th>
                                <th>Î∞∞ÌÑ∞Î¶¨</th>
                                <th>ÏúÑÏπò</th>
                                <th>Ï†úÏñ¥</th>
                            </tr>
                        </thead>
                        <tbody id="individualRobotTableBody">
                            <!-- Í∞úÎ≥Ñ Î°úÎ¥á Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="control-card">
                <h3 class="control-title">‚öôÔ∏è ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏÑ§Ï†ï</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="seedInput">ÎûúÎç§ ÏãúÎìú</label>
                        <input type="number" id="seedInput" placeholder="12345" value="12345">
                    </div>
                    <div class="setting-item">
                        <label for="intervalInput">ÎØ∏ÏÖò Í∞ÑÍ≤© (Î∂Ñ)</label>
                        <input type="number" id="intervalInput" placeholder="10" value="10" min="1" max="60">
                    </div>
                    <div class="setting-item">
                        <label for="strictMode">ÏóÑÍ≤© Î™®Îìú</label>
                        <select id="strictMode">
                            <option value="false">ÎπÑÌôúÏÑ±Ìôî</option>
                            <option value="true">ÌôúÏÑ±Ìôî</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label for="normalizedMode">Ï†ïÍ∑úÌôî Î™®Îìú</label>
                        <select id="normalizedMode">
                            <option value="false">Îã®Ïùº Ïª¨Î†âÏÖò</option>
                            <option value="true">Ï†ïÍ∑úÌôî Ï†ÄÏû•</option>
                        </select>
                    </div>
                </div>
                <div class="control-buttons">
                    <button class="btn btn-start" id="applySettingsBtn">‚öôÔ∏è ÏÑ§Ï†ï Ï†ÅÏö©</button>
                    <button class="btn btn-stop" id="resetSettingsBtn">üîÑ ÏÑ§Ï†ï Ï¥àÍ∏∞Ìôî</button>
                </div>
            </div>

            <div class="control-card">
                <h3 class="control-title">üóÑÔ∏è MongoDB ÏÑ§Ï†ï</h3>
                <div class="mongodb-config-section">
                    <div class="connection-status" id="mongoConnectionStatus">
                        <span class="status-indicator" id="mongoStatusIndicator">üî¥</span>
                        <span id="mongoStatusText">Ïó∞Í≤∞ ÏÉÅÌÉú ÌôïÏù∏ Ï§ë...</span>
                    </div>
                    
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label for="mongoConnectionString">Ïó∞Í≤∞ Î¨∏ÏûêÏó¥</label>
                            <input type="text" id="mongoConnectionString" 
                                   placeholder="mongodb://localhost:27017/" 
                                   value="mongodb://localhost:27017/">
                        </div>
                        <div class="setting-item">
                            <label for="mongoDatabaseName">Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Î™Ö</label>
                            <input type="text" id="mongoDatabaseName" 
                                   placeholder="robot_data" 
                                   value="robot_data">
                        </div>
                        <div class="setting-item">
                            <label for="mongoCollectionName">Ïª¨Î†âÏÖòÎ™Ö</label>
                            <input type="text" id="mongoCollectionName" 
                                   placeholder="robot_missions" 
                                   value="robot_missions">
                        </div>
                    </div>
                    
                    <div class="mongo-actions">
                        <button type="button" class="btn btn-primary" onclick="dashboard.testMongoConnection()">
                            üîç Ïó∞Í≤∞ ÌÖåÏä§Ìä∏
                        </button>
                        <button type="button" class="btn btn-success" onclick="dashboard.saveMongoConfig()">
                            üíæ ÏÑ§Ï†ï Ï†ÄÏû•
                        </button>
                        <button type="button" class="btn btn-warning" onclick="dashboard.loadMongoConfig()">
                            üìã ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞
                        </button>
                    </div>
                    
                    <div class="mongo-test-result" id="mongoTestResult" style="display: none;">
                        <div class="test-result-content" id="mongoTestContent"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ïã§ÏãúÍ∞Ñ Î°úÍ∑∏ -->
        <div class="logs-section">
            <div class="logs-header">
                <h3 class="logs-title">üìù Ïã§ÏãúÍ∞Ñ Ïö¥ÏòÅ Î°úÍ∑∏</h3>
            </div>
            <div class="log-container" id="logContainer">
                <div class="log-entry log-info">[16:55:52] ÏãúÏä§ÌÖú Ï¥àÍ∏∞Ìôî ÏôÑÎ£å - 30ÎåÄ Î°úÎ¥á Ïó∞Í≤∞Îê®</div>
                <div class="log-entry log-success">[16:55:53] AGV-001: H3-17L ‚Üí K2-15L Ïù¥Îèô ÏãúÏûë</div>
                <div class="log-entry log-success">[16:55:54] AGV-002: P1-12L ÏûëÏóÖ ÏôÑÎ£å (Ï≤òÎ¶¨ÏãúÍ∞Ñ: 4.2Î∂Ñ)</div>
                <div class="log-entry log-warning">[16:55:55] AGV-003: Î∞∞ÌÑ∞Î¶¨ Î∂ÄÏ°± Í≤ΩÍ≥† (25%)</div>
                <div class="log-entry log-error">[16:55:56] AGV-015: ÌÜµÏã† ÎÅäÍπÄ Í∞êÏßÄ</div>
            </div>
        </div>
    </div>

    <!-- Î°úÎî© ÌëúÏãú -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div>Ï≤òÎ¶¨ Ï§ë...</div>
    </div>

    <script>
        class OperationalDashboard {
            constructor() {
                this.apiUrl = 'http://localhost:8080';
                this.updateIntervals = {};
                this.robotLocations = new Map();
                
                this.initializeElements();
                this.bindEvents();
                this.startRealTimeUpdates();
                
                // Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                this.updateOperationalData();
                this.updateRobotMap();
                this.updateWorkProgress();
                this.updateRealTimeAlerts();
                this.updateIndividualRobotTable();
            }

            initializeElements() {
                // ÌÜµÍ≥Ñ ÏöîÏÜåÎì§
                this.todayMissions = document.getElementById('todayMissions');
                this.achievementRate = document.getElementById('achievementRate');
                this.avgProcessTime = document.getElementById('avgProcessTime');
                this.workingRobots = document.getElementById('workingRobots');
                this.movingRobots = document.getElementById('movingRobots');
                this.idleRobots = document.getElementById('idleRobots');
                this.problemRobots = document.getElementById('problemRobots');
                this.avgBattery = document.getElementById('avgBattery');
                this.lowBatteryRobots = document.getElementById('lowBatteryRobots');
                this.chargingNeeded = document.getElementById('chargingNeeded');
                
                // Îßµ ÏöîÏÜåÎì§
                this.factoryLayout = document.getElementById('factoryLayout');
                this.workProgressList = document.getElementById('workProgressList');
                this.alertsList = document.getElementById('alertsList');
                this.logContainer = document.getElementById('logContainer');
                
                // Ï†úÏñ¥ ÏöîÏÜåÎì§
                this.startSimBtn = document.getElementById('startSimBtn');
                this.stopSimBtn = document.getElementById('stopSimBtn');
                this.startAllBtn = document.getElementById('startAllBtn');
                this.stopAllBtn = document.getElementById('stopAllBtn');
                this.emergencyBtn = document.getElementById('emergencyBtn');
                
                // Í∞úÎ≥Ñ Î°úÎ¥á Ï†úÏñ¥ ÏöîÏÜåÎì§
                this.individualRobotTableBody = document.getElementById('individualRobotTableBody');
                this.seedInput = document.getElementById('seedInput');
                this.intervalInput = document.getElementById('intervalInput');
                this.strictMode = document.getElementById('strictMode');
                this.normalizedMode = document.getElementById('normalizedMode');
                this.applySettingsBtn = document.getElementById('applySettingsBtn');
                this.resetSettingsBtn = document.getElementById('resetSettingsBtn');
                
                // ÏÉÅÌÉú ÏöîÏÜåÎì§
                this.simulatorStatus = document.getElementById('simulatorStatus');
                this.simulatorUptime = document.getElementById('simulatorUptime');
                this.loading = document.getElementById('loading');
            }

            bindEvents() {
                this.startSimBtn?.addEventListener('click', () => this.startSimulator());
                this.stopSimBtn?.addEventListener('click', () => this.stopSimulator());
                this.startAllBtn?.addEventListener('click', () => this.startAllRobots());
                this.stopAllBtn?.addEventListener('click', () => this.stopAllRobots());
                this.emergencyBtn?.addEventListener('click', () => this.emergencyStop());
                
                // ÏÑ§Ï†ï Î≤ÑÌäº Ïù¥Î≤§Ìä∏
                this.applySettingsBtn?.addEventListener('click', () => this.applySettings());
                this.resetSettingsBtn?.addEventListener('click', () => this.resetSettings());
            }

            startRealTimeUpdates() {
                // Ïö¥ÏòÅ Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ (5Ï¥àÎßàÎã§)
                this.updateIntervals.operational = setInterval(() => {
                    this.updateOperationalData();
                }, 5000);
                
                // Î°úÎ¥á Îßµ ÏóÖÎç∞Ïù¥Ìä∏ (3Ï¥àÎßàÎã§)
                this.updateIntervals.robotMap = setInterval(() => {
                    this.updateRobotMap();
                }, 3000);
                
                // ÏûëÏóÖ ÏßÑÌñâ ÏÉÅÌô© ÏóÖÎç∞Ïù¥Ìä∏ (2Ï¥àÎßàÎã§)
                this.updateIntervals.workProgress = setInterval(() => {
                    this.updateWorkProgress();
                }, 2000);
                
                // Ïã§ÏãúÍ∞Ñ ÏïåÎ¶º ÏóÖÎç∞Ïù¥Ìä∏ (10Ï¥àÎßàÎã§)
                this.updateIntervals.alerts = setInterval(() => {
                    this.updateRealTimeAlerts();
                }, 10000);
                
                // Í∞úÎ≥Ñ Î°úÎ¥á ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏ (5Ï¥àÎßàÎã§)
                this.updateIntervals.individualRobots = setInterval(() => {
                    this.updateIndividualRobotTable();
                }, 5000);
                
                // ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏ (1Ï¥àÎßàÎã§)
                this.updateIntervals.simulator = setInterval(() => {
                    this.updateSimulatorStatus();
                }, 1000);
            }

            async updateOperationalData() {
                try {
                    // üî• Ïã§Ï†ú MongoDB API Ìò∏Ï∂ú
                    const response = await fetch(`${this.apiUrl}/api/stats/operational`);
                    const data = await response.json();
                    
                    if (response.ok && data.success) {
                        // Ïã§Ï†ú MongoDB Îç∞Ïù¥ÌÑ∞Î°ú ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateElement(this.todayMissions, data.daily_stats?.completed_missions || 0);
                        this.updateElement(this.achievementRate, `${data.daily_stats?.success_rate || 0}%`);
                        this.updateElement(this.avgProcessTime, `${data.daily_stats?.avg_process_time || 0}Î∂Ñ`);
                        
                        // Ïã§ÏãúÍ∞Ñ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateElement(this.workingRobots, `${data.robot_status?.working || 0}ÎåÄ`);
                        this.updateElement(this.movingRobots, `${data.robot_status?.moving || 0}ÎåÄ`);
                        this.updateElement(this.idleRobots, `${data.robot_status?.idle || 0}ÎåÄ`);
                        this.updateElement(this.problemRobots, `${data.robot_status?.error || 0}ÎåÄ`);
                        
                        // Î∞∞ÌÑ∞Î¶¨ ÌòÑÌô© ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateElement(this.avgBattery, `${data.battery_stats?.average || 0}%`);
                        this.updateElement(this.lowBatteryRobots, `${data.battery_stats?.low_count || 0}ÎåÄ`);
                        this.updateElement(this.chargingNeeded, `${data.battery_stats?.critical_count || 0}ÎåÄ`);
                        
                        this.addLog(`üìä Ïã§Ï†ú MongoDB Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`, 'success');
                    } else {
                        // API Ïã§Ìå® Ïãú Ìè¥Î∞±: Í∏∞Î≥∏Í∞í ÌëúÏãú
                        throw new Error(data.error || 'API Ìò∏Ï∂ú Ïã§Ìå®');
                    }
                    
                } catch (error) {
                    this.addLog(`‚ö†Ô∏è MongoDB Ïó∞Í≤∞ Ïã§Ìå®, Í∏∞Î≥∏Í∞í ÌëúÏãú: ${error.message}`, 'warning');
                    // Ìè¥Î∞±: MongoDB Ïó∞Í≤∞ Ïã§Ìå® Ïãú Í∏∞Î≥∏Í∞í
                    this.updateElement(this.todayMissions, '-');
                    this.updateElement(this.achievementRate, '-');
                    this.updateElement(this.avgProcessTime, '-');
                    this.updateElement(this.workingRobots, '-');
                    this.updateElement(this.movingRobots, '-');
                    this.updateElement(this.idleRobots, '-');
                    this.updateElement(this.problemRobots, '-');
                    this.updateElement(this.avgBattery, '-');
                    this.updateElement(this.lowBatteryRobots, '-');
                    this.updateElement(this.chargingNeeded, '-');
                }
            }

            generateMockOperationalData() {
                const now = new Date();
                const variance = Math.sin(now.getTime() / 10000) * 10;
                
                return {
                    daily_stats: {
                        completed_missions: Math.floor(847 + variance),
                        success_rate: Math.floor(94 + variance / 2),
                        avg_process_time: (4.2 + variance / 10).toFixed(1)
                    },
                    robot_status: {
                        working: Math.floor(18 + variance / 2),
                        moving: Math.floor(7 + variance / 3),
                        idle: Math.floor(3 + Math.abs(variance) / 5),
                        error: Math.floor(2 + Math.abs(variance) / 8)
                    },
                    battery_stats: {
                        average: Math.floor(78 + variance),
                        low_count: Math.floor(3 + Math.abs(variance) / 5),
                        critical_count: Math.floor(1 + Math.abs(variance) / 10)
                    }
                };
            }

            async updateRobotMap() {
                try {
                    // üî• Ïã§Ï†ú MongoDB API Ìò∏Ï∂ú
                    const response = await fetch(`${this.apiUrl}/api/robots`);
                    const data = await response.json();
                    
                    if (response.ok && data.success) {
                        // Ïã§Ï†ú MongoDB Î°úÎ¥á Îç∞Ïù¥ÌÑ∞ ÏÇ¨Ïö©
                        this.renderRobotMap(data.robots);
                        this.updateMapStatus(data.summary);
                        this.addLog(`üó∫Ô∏è Ïã§Ï†ú Î°úÎ¥á ÏúÑÏπò Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`, 'success');
                    } else {
                        throw new Error(data.error || 'Î°úÎ¥á Îç∞Ïù¥ÌÑ∞ API Ìò∏Ï∂ú Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ö†Ô∏è Î°úÎ¥á Îßµ MongoDB Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, 'warning');
                    // Ìè¥Î∞±: Í∞ÄÏßú Îç∞Ïù¥ÌÑ∞Î°ú ÎåÄÏ≤¥
                    const mockRobots = this.generateMockRobotData();
                    this.renderRobotMap(mockRobots);
                    this.updateMapStatus(this.calculateRobotSummary(mockRobots));
                }
            }

            generateMockRobotData() {
                const robots = [];
                const statuses = ['running', 'moving', 'idle', 'error', 'charging'];
                const now = Date.now();
                
                for (let i = 1; i <= 30; i++) {
                    const robotId = `AGV-${i.toString().padStart(3, '0')}`;
                    const statusIndex = Math.floor((i * 7 + now / 5000) % statuses.length);
                    
                    robots.push({
                        robot_id: robotId,
                        status: statuses[statusIndex],
                        battery_level: Math.floor(30 + (i * 13 + now / 1000) % 70),
                        last_seen: new Date(now - (i * 1000)).toISOString(),
                        uptime: i * 100 + Math.floor(now / 1000) % 1000
                    });
                }
                
                return robots;
            }

            calculateRobotSummary(robots) {
                return {
                    running: robots.filter(r => r.status === 'running').length,
                    idle: robots.filter(r => r.status === 'idle' || r.status === 'charging').length,
                    error: robots.filter(r => r.status === 'error').length
                };
            }

            renderRobotMap(robots) {
                // Íµ¨Ïó≠Î≥ÑÎ°ú Î°úÎ¥á Î∂ÑÎ•ò
                const zones = {
                    'H3': { robots: [], element: document.getElementById('zone-H3-robots') },
                    'K2': { robots: [], element: document.getElementById('zone-K2-robots') },
                    'P1': { robots: [], element: document.getElementById('zone-P1-robots') },
                    'CHARGE': { robots: [], element: document.getElementById('zone-CHARGE-robots') }
                };

                // Î°úÎ¥áÏùÑ Íµ¨Ïó≠Î≥ÑÎ°ú Î∂ÑÎ•ò
                robots.forEach(robot => {
                    const location = this.getRobotZone(robot);
                    if (zones[location]) {
                        zones[location].robots.push(robot);
                    }
                });

                // Í∞Å Íµ¨Ïó≠Ïóê Î°úÎ¥á ÌëúÏãú
                Object.keys(zones).forEach(zoneKey => {
                    const zone = zones[zoneKey];
                    if (!zone.element) return;

                    if (zone.robots.length === 0) {
                        zone.element.innerHTML = '<div class="zone-empty">ÎπÑÏñ¥ÏûàÏùå</div>';
                    } else {
                        zone.element.innerHTML = zone.robots.map(robot => `
                            <div class="robot-in-zone">
                                <div class="robot-status-icon status-${this.getRobotStatusClass(robot.status)}"></div>
                                <span>${robot.robot_id}</span>
                                <span>${this.getRobotStatusText(robot.status)}</span>
                                <span>${robot.battery_level}%</span>
                            </div>
                        `).join('');
                    }
                });
            }

            getRobotZone(robot) {
                const robotNumber = parseInt(robot.robot_id.split('-')[1]);
                
                if (robot.status === 'charging' || robot.battery_level < 30) {
                    return 'CHARGE';
                }
                
                const zones = ['H3', 'K2', 'P1'];
                return zones[robotNumber % 3];
            }

            getRobotStatusClass(status) {
                const statusMap = {
                    'running': 'working',
                    'moving': 'moving',
                    'idle': 'idle',
                    'error': 'error',
                    'charging': 'charging'
                };
                return statusMap[status] || 'idle';
            }

            getRobotStatusText(status) {
                const statusMap = {
                    'running': 'ÏûëÏóÖÏ§ë',
                    'moving': 'Ïù¥ÎèôÏ§ë',
                    'idle': 'ÎåÄÍ∏∞Ï§ë',
                    'error': 'Ïò§Î•ò',
                    'charging': 'Ï∂©Ï†ÑÏ§ë'
                };
                return statusMap[status] || status;
            }

            updateMapStatus(summary) {
                const activeElement = document.getElementById('activeRobotsStatus');
                const warningElement = document.getElementById('warningRobotsStatus');
                const errorElement = document.getElementById('errorRobotsStatus');
                
                if (activeElement) activeElement.textContent = `Ï†ïÏÉÅ: ${summary.running || 0}ÎåÄ`;
                if (warningElement) warningElement.textContent = `Ï£ºÏùò: ${summary.idle || 0}ÎåÄ`;
                if (errorElement) errorElement.textContent = `Î¨∏Ï†ú: ${summary.error || 0}ÎåÄ`;
            }

            async updateWorkProgress() {
                try {
                    // üî• Ïã§Ï†ú MongoDB API Ìò∏Ï∂ú
                    const response = await fetch(`${this.apiUrl}/api/robots`);
                    const data = await response.json();
                    
                    if (response.ok && data.success) {
                        // Ïã§Ï†ú MongoDB Î°úÎ¥á Îç∞Ïù¥ÌÑ∞Î°ú ÏûëÏóÖ ÏßÑÌñâ ÏÉÅÌô© ÌëúÏãú
                        this.renderWorkProgress(data.robots);
                        this.addLog(`üöÄ Ïã§Ï†ú ÏûëÏóÖ ÏßÑÌñâ ÏÉÅÌô© ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`, 'success');
                    } else {
                        throw new Error(data.error || 'ÏûëÏóÖ ÏßÑÌñâ API Ìò∏Ï∂ú Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ö†Ô∏è ÏûëÏóÖ ÏßÑÌñâ MongoDB Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, 'warning');
                    // Ìè¥Î∞±: Í∞ÄÏßú Îç∞Ïù¥ÌÑ∞Î°ú ÎåÄÏ≤¥
                    const mockRobots = this.generateMockRobotData();
                    this.renderWorkProgress(mockRobots);
                }
            }

            renderWorkProgress(robots) {
                // ÏûëÏóÖ Ï§ëÏù∏ Î°úÎ¥áÎßå ÌëúÏãú
                const workingRobots = robots.filter(robot => 
                    robot.status === 'running' || robot.status === 'moving'
                ).slice(0, 6); // ÏµúÎåÄ 6Í∞úÎßå ÌëúÏãú

                if (!this.workProgressList) return;

                if (workingRobots.length === 0) {
                    this.workProgressList.innerHTML = '<div class="zone-empty">ÌòÑÏû¨ ÏûëÏóÖ Ï§ëÏù∏ Î°úÎ¥áÏù¥ ÏóÜÏäµÎãàÎã§</div>';
                    return;
                }

                this.workProgressList.innerHTML = workingRobots.map(robot => {
                    const progress = this.calculateRobotProgress(robot);
                    const workDetails = this.generateWorkDetails(robot);
                    
                    return `
                        <div class="work-item">
                            <div class="work-item-header">
                                <span class="robot-id">${robot.robot_id}</span>
                                <span class="work-status ${robot.status}">${this.getRobotStatusText(robot.status)}</span>
                            </div>
                            <div class="work-details">${workDetails}</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progress}%"></div>
                            </div>
                            <div class="work-meta">
                                <span>Î∞∞ÌÑ∞Î¶¨: ${robot.battery_level}%</span>
                                <span>ÏòàÏÉÅ ÏôÑÎ£å: ${this.calculateETA(robot)}Î∂Ñ</span>
                                <span>ÏßÑÌñâÎ•†: ${progress}%</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            calculateRobotProgress(robot) {
                const robotNumber = parseInt(robot.robot_id.split('-')[1]);
                const baseProgress = (robotNumber * 7 + Date.now() / 10000) % 100;
                return Math.floor(baseProgress);
            }

            generateWorkDetails(robot) {
                const locations = ['H3-17L', 'K2-15L', 'P1-12L', 'H2-08L', 'K1-14L'];
                const robotNumber = parseInt(robot.robot_id.split('-')[1]);
                const fromLocation = locations[robotNumber % locations.length];
                const toLocation = locations[(robotNumber + 1) % locations.length];
                
                if (robot.status === 'moving') {
                    return `${fromLocation} ‚Üí ${toLocation} Ïù¥Îèô Ï§ë`;
                } else {
                    return `${fromLocation}ÏóêÏÑú ÏûëÏóÖ ÏàòÌñâ Ï§ë`;
                }
            }

            calculateETA(robot) {
                const progress = this.calculateRobotProgress(robot);
                const remaining = 100 - progress;
                return Math.ceil(remaining / 20);
            }

            async updateSimulatorStatus() {
                try {
                    const response = await fetch(`${this.apiUrl}/api/status`);
                    const status = await response.json();
                    
                    if (response.ok) {
                        this.updateElement(this.simulatorStatus, status.is_running ? 'Ïã§Ìñâ Ï§ë' : 'Ï†ïÏßÄÎê®');
                        this.updateElement(this.simulatorUptime, status.is_running ? 
                            `${Math.floor(status.uptime_seconds || 0)}Ï¥à` : '0Ï¥à');
                        
                        // Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                        if (this.startSimBtn) this.startSimBtn.disabled = status.is_running;
                        if (this.stopSimBtn) this.stopSimBtn.disabled = !status.is_running;
                    }
                } catch (error) {
                    // Ï°∞Ïö©Ìûà Ïã§Ìå® Ï≤òÎ¶¨
                }
            }

            async startSimulator() {
                this.showLoading(true);
                try {
                    const response = await fetch(`${this.apiUrl}/api/start`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            seed: 12345,
                            strict_mode: false,
                            normalized_mode: false,
                            interval: 10
                        })
                    });

                    const result = await response.json();
                    
                    if (response.ok) {
                        this.addLog(`‚úÖ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏãúÏûëÎê®`, 'success');
                    } else {
                        throw new Error(result.error || result.message);
                    }
                } catch (error) {
                    this.addLog(`‚ùå ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ ÏãúÏûë Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            async stopSimulator() {
                this.showLoading(true);
                try {
                    const response = await fetch(`${this.apiUrl}/api/stop`, {
                        method: 'POST'
                    });

                    const result = await response.json();
                    
                    if (response.ok) {
                        this.addLog(`‚èπÔ∏è ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ Ï†ïÏßÄÎê®`, 'success');
                    } else {
                        throw new Error(result.error || result.message);
                    }
                } catch (error) {
                    this.addLog(`‚ùå ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ Ï†ïÏßÄ Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            async startAllRobots() {
                this.showLoading(true);
                try {
                    // üî• Ïã§Ï†ú Ï†ÑÏ≤¥ Î°úÎ¥á ÏãúÏûë API Ìò∏Ï∂ú
                    const response = await fetch(`${this.apiUrl}/api/robots/start-all`, {
                        method: 'POST'
                    });
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        this.addLog(`‚úÖ Ï†ÑÏ≤¥ Î°úÎ¥á ÏãúÏûë ÏôÑÎ£å: ${result.message}`, 'success');
                        // Ï¶âÏãú Î°úÎ¥á ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateRobotMap();
                        this.updateWorkProgress();
                    } else {
                        throw new Error(result.error || 'Ï†ÑÏ≤¥ ÏãúÏûë API Ìò∏Ï∂ú Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ùå Ï†ÑÏ≤¥ Î°úÎ¥á ÏãúÏûë Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            async stopAllRobots() {
                if (confirm('Î™®Îì† Î°úÎ¥áÏùÑ Ï†ïÏßÄÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    this.showLoading(true);
                    try {
                        // üî• Ïã§Ï†ú Ï†ÑÏ≤¥ Î°úÎ¥á Ï†ïÏßÄ API Ìò∏Ï∂ú
                        const response = await fetch(`${this.apiUrl}/api/robots/stop-all`, {
                            method: 'POST'
                        });
                        const result = await response.json();
                        
                        if (response.ok && result.success) {
                            this.addLog(`‚úÖ Ï†ÑÏ≤¥ Î°úÎ¥á Ï†ïÏßÄ ÏôÑÎ£å: ${result.message}`, 'success');
                            // Ï¶âÏãú Î°úÎ¥á ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                            this.updateRobotMap();
                            this.updateWorkProgress();
                        } else {
                            throw new Error(result.error || 'Ï†ÑÏ≤¥ Ï†ïÏßÄ API Ìò∏Ï∂ú Ïã§Ìå®');
                        }
                    } catch (error) {
                        this.addLog(`‚ùå Ï†ÑÏ≤¥ Î°úÎ¥á Ï†ïÏßÄ Ïã§Ìå®: ${error.message}`, 'error');
                    } finally {
                        this.showLoading(false);
                    }
                }
            }

            async emergencyStop() {
                if (confirm('üö® ÎπÑÏÉÅ Ï†ïÏßÄÎ•º Ïã§ÌñâÌïòÏãúÍ≤†ÏäµÎãàÍπå? Î™®Îì† Î°úÎ¥áÏù¥ Ï¶âÏãú Ï†ïÏßÄÎê©ÎãàÎã§.')) {
                    this.addLog(`üö® ÎπÑÏÉÅ Ï†ïÏßÄ Î™ÖÎ†π Ïã§Ìñâ!`, 'error');
                }
            }

            async updateRealTimeAlerts() {
                try {
                    // üî• Ïã§Ï†ú MongoDB Í∏∞Î∞ò ÏïåÎ¶º ÏÉùÏÑ±
                    const response = await fetch(`${this.apiUrl}/api/robots`);
                    const data = await response.json();
                    
                    if (response.ok && data.success) {
                        const alerts = this.generateRealAlertsFromData(data.robots);
                        this.renderRealTimeAlerts(alerts);
                        this.addLog(`üö® Ïã§Ï†ú MongoDB Í∏∞Î∞ò ÏïåÎ¶º ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`, 'success');
                    } else {
                        throw new Error(data.error || 'ÏïåÎ¶º Îç∞Ïù¥ÌÑ∞ API Ìò∏Ï∂ú Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ö†Ô∏è Ïã§ÏãúÍ∞Ñ ÏïåÎ¶º MongoDB Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, 'warning');
                    // Ìè¥Î∞±: Í∏∞Î≥∏ ÏïåÎ¶º ÌëúÏãú
                    this.renderFallbackAlerts();
                }
            }

            generateRealAlertsFromData(robots) {
                const alerts = [];
                const now = new Date();
                
                robots.forEach(robot => {
                    // Î∞∞ÌÑ∞Î¶¨ Î∂ÄÏ°± ÏïåÎ¶º (30% Ïù¥Ìïò)
                    if (robot.battery_level <= 30) {
                        alerts.push({
                            icon: 'üîã',
                            message: `${robot.robot_id} Î∞∞ÌÑ∞Î¶¨ Î∂ÄÏ°± (${robot.battery_level}%)`,
                            time: this.getRelativeTime(robot.last_seen),
                            priority: robot.battery_level <= 15 ? 'high' : 'medium'
                        });
                    }
                    
                    // ÌÜµÏã† ÎÅäÍπÄ ÏïåÎ¶º (5Î∂Ñ Ïù¥ÏÉÅ ÏóÖÎç∞Ïù¥Ìä∏ ÏóÜÏùå)
                    if (robot.last_seen) {
                        const lastSeenTime = new Date(robot.last_seen);
                        const timeDiff = (now - lastSeenTime) / 1000 / 60; // Î∂Ñ Îã®ÏúÑ
                        
                        if (timeDiff > 5) {
                            alerts.push({
                                icon: 'üì°',
                                message: `${robot.robot_id} ÌÜµÏã† ÎÅäÍπÄ (${Math.floor(timeDiff)}Î∂Ñ Ï†Ñ)`,
                                time: `${Math.floor(timeDiff)}Î∂Ñ Ï†Ñ`,
                                priority: timeDiff > 10 ? 'high' : 'medium'
                            });
                        }
                    }
                    
                    // Ïò§Î•ò ÏÉÅÌÉú ÏïåÎ¶º
                    if (robot.status === 'error') {
                        alerts.push({
                            icon: '‚ö†Ô∏è',
                            message: `${robot.robot_id} ÏãúÏä§ÌÖú Ïò§Î•ò Î∞úÏÉù`,
                            time: this.getRelativeTime(robot.last_seen),
                            priority: 'high'
                        });
                    }
                    
                    // Ïû•ÏãúÍ∞Ñ ÎåÄÍ∏∞ ÏïåÎ¶º (30Î∂Ñ Ïù¥ÏÉÅ idle)
                    if (robot.status === 'idle' && robot.uptime > 1800) { // 30Î∂Ñ = 1800Ï¥à
                        alerts.push({
                            icon: '‚è∞',
                            message: `${robot.robot_id} Ïû•ÏãúÍ∞Ñ ÎåÄÍ∏∞ Ï§ë (${Math.floor(robot.uptime / 60)}Î∂Ñ)`,
                            time: this.getRelativeTime(robot.last_seen),
                            priority: 'low'
                        });
                    }
                });
                
                // ÏµúÏã† ÏàúÏúºÎ°ú Ï†ïÎ†¨ÌïòÍ≥† ÏµúÎåÄ 10Í∞úÎßå
                return alerts.sort((a, b) => {
                    const priorityOrder = { 'high': 3, 'medium': 2, 'low': 1 };
                    return priorityOrder[b.priority] - priorityOrder[a.priority];
                }).slice(0, 10);
            }

            renderRealTimeAlerts(alerts) {
                if (!this.alertsList) return;
                
                // Ï¥ù ÏïåÎ¶º Ïàò ÏóÖÎç∞Ïù¥Ìä∏
                const totalAlertsElement = document.getElementById('totalAlerts');
                if (totalAlertsElement) {
                    totalAlertsElement.textContent = alerts.length;
                }
                
                if (alerts.length === 0) {
                    this.alertsList.innerHTML = '<div class="zone-empty">ÌòÑÏû¨ ÏïåÎ¶ºÏù¥ ÏóÜÏäµÎãàÎã§ ‚úÖ</div>';
                    return;
                }
                
                this.alertsList.innerHTML = alerts.map(alert => `
                    <div class="alert-item">
                        <span class="alert-icon">${alert.icon}</span>
                        <div class="alert-content">
                            <div class="alert-message">${alert.message}</div>
                            <div class="alert-time">${alert.time}</div>
                        </div>
                        <span class="alert-priority priority-${alert.priority}">
                            ${alert.priority === 'high' ? 'Í∏¥Í∏â' : alert.priority === 'medium' ? 'Ï£ºÏùò' : 'Ï†ïÎ≥¥'}
                        </span>
                    </div>
                `).join('');
            }

            renderFallbackAlerts() {
                if (!this.alertsList) return;
                
                this.alertsList.innerHTML = `
                    <div class="alert-item">
                        <span class="alert-icon">‚ö†Ô∏è</span>
                        <div class="alert-content">
                            <div class="alert-message">MongoDB Ïó∞Í≤∞ ÎÅäÍπÄ - ÏïåÎ¶º ÏãúÏä§ÌÖú ÎåÄÍ∏∞ Ï§ë</div>
                            <div class="alert-time">Î∞©Í∏à Ï†Ñ</div>
                        </div>
                        <span class="alert-priority priority-medium">Ï£ºÏùò</span>
                    </div>
                `;
            }

            getRelativeTime(timestamp) {
                if (!timestamp) return 'Ïïå Ïàò ÏóÜÏùå';
                
                const now = new Date();
                const time = new Date(timestamp);
                const diff = Math.floor((now - time) / 1000);
                
                if (diff < 60) return `${diff}Ï¥à Ï†Ñ`;
                if (diff < 3600) return `${Math.floor(diff / 60)}Î∂Ñ Ï†Ñ`;
                if (diff < 86400) return `${Math.floor(diff / 3600)}ÏãúÍ∞Ñ Ï†Ñ`;
                return `${Math.floor(diff / 86400)}Ïùº Ï†Ñ`;
            }

            async updateIndividualRobotTable() {
                try {
                    // üî• Ïã§Ï†ú MongoDB API Ìò∏Ï∂ú
                    const response = await fetch(`${this.apiUrl}/api/robots`);
                    const data = await response.json();
                    
                    if (response.ok && data.success) {
                        this.renderIndividualRobotTable(data.robots);
                        this.addLog(`ü§ñ Í∞úÎ≥Ñ Î°úÎ¥á ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏ ÏôÑÎ£å`, 'success');
                    } else {
                        throw new Error(data.error || 'Í∞úÎ≥Ñ Î°úÎ¥á API Ìò∏Ï∂ú Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ö†Ô∏è Í∞úÎ≥Ñ Î°úÎ¥á ÌÖåÏù¥Î∏î MongoDB Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, 'warning');
                    // Ìè¥Î∞±: Í∏∞Î≥∏ Î©îÏãúÏßÄ ÌëúÏãú
                    if (this.individualRobotTableBody) {
                        this.individualRobotTableBody.innerHTML = '<tr><td colspan="5">MongoDB Ïó∞Í≤∞ Ïã§Ìå® - Î°úÎ¥á Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§</td></tr>';
                    }
                }
            }

            renderIndividualRobotTable(robots) {
                if (!this.individualRobotTableBody) return;
                
                this.individualRobotTableBody.innerHTML = robots.map(robot => {
                    const location = this.getRobotLocation(robot);
                    const statusClass = this.getRobotStatusClass(robot.status);
                    const statusText = this.getRobotStatusText(robot.status);
                    
                    return `
                        <tr>
                            <td><strong>${robot.robot_id}</strong></td>
                            <td>
                                <span class="robot-status ${statusClass}">
                                    ${this.getStatusIcon(robot.status)} ${statusText}
                                </span>
                            </td>
                            <td>
                                <span class="battery-level ${this.getBatteryClass(robot.battery_level)}">
                                    ${robot.battery_level}%
                                </span>
                            </td>
                            <td>${location}</td>
                            <td>
                                <div class="robot-controls-cell">
                                    ${robot.status === 'running' ? 
                                        `<button class="robot-btn stop" onclick="operationalDashboard.stopIndividualRobot('${robot.robot_id}')">Ï†ïÏßÄ</button>` :
                                        `<button class="robot-btn start" onclick="operationalDashboard.startIndividualRobot('${robot.robot_id}')">ÏãúÏûë</button>`
                                    }
                                    <button class="robot-btn reset" onclick="operationalDashboard.resetIndividualRobot('${robot.robot_id}')">Î¶¨ÏÖã</button>
                                </div>
                            </td>
                        </tr>
                    `;
                }).join('');
            }

            getRobotLocation(robot) {
                // Ïã§Ï†ú Î°úÎ¥á ÏúÑÏπò Ï†ïÎ≥¥ ÏÉùÏÑ±
                const zones = ['H3-17L', 'K2-15L', 'P1-12L', 'H2-08L', 'K1-14L'];
                const robotNumber = parseInt(robot.robot_id.split('-')[1]);
                return zones[robotNumber % zones.length];
            }

            getStatusIcon(status) {
                const icons = {
                    'running': 'üü¢',
                    'moving': 'üîµ',
                    'idle': 'üü°',
                    'error': 'üî¥',
                    'charging': 'üü£'
                };
                return icons[status] || '‚ùì';
            }

            getBatteryClass(level) {
                if (level >= 60) return 'good';
                if (level >= 30) return 'warning';
                return 'danger';
            }

            async startIndividualRobot(robotId) {
                this.showLoading(true);
                try {
                    const response = await fetch(`${this.apiUrl}/api/robots/${robotId}/start`, {
                        method: 'POST'
                    });
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        this.addLog(`‚úÖ Î°úÎ¥á ${robotId} ÏãúÏûë ÏôÑÎ£å`, 'success');
                        // Ï¶âÏãú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateIndividualRobotTable();
                        this.updateRobotMap();
                    } else {
                        throw new Error(result.error || `Î°úÎ¥á ${robotId} ÏãúÏûë Ïã§Ìå®`);
                    }
                } catch (error) {
                    this.addLog(`‚ùå Î°úÎ¥á ${robotId} ÏãúÏûë Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            async stopIndividualRobot(robotId) {
                this.showLoading(true);
                try {
                    const response = await fetch(`${this.apiUrl}/api/robots/${robotId}/stop`, {
                        method: 'POST'
                    });
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        this.addLog(`üõë Î°úÎ¥á ${robotId} Ï†ïÏßÄ ÏôÑÎ£å`, 'success');
                        // Ï¶âÏãú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateIndividualRobotTable();
                        this.updateRobotMap();
                    } else {
                        throw new Error(result.error || `Î°úÎ¥á ${robotId} Ï†ïÏßÄ Ïã§Ìå®`);
                    }
                } catch (error) {
                    this.addLog(`‚ùå Î°úÎ¥á ${robotId} Ï†ïÏßÄ Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            async resetIndividualRobot(robotId) {
                this.showLoading(true);
                try {
                    const response = await fetch(`${this.apiUrl}/api/robots/${robotId}/reset`, {
                        method: 'POST'
                    });
                    const result = await response.json();
                    
                    if (response.ok && result.success) {
                        this.addLog(`üîÑ Î°úÎ¥á ${robotId} Î¶¨ÏÖã ÏôÑÎ£å`, 'success');
                        // Ï¶âÏãú ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateIndividualRobotTable();
                        this.updateRobotMap();
                    } else {
                        throw new Error(result.error || `Î°úÎ¥á ${robotId} Î¶¨ÏÖã Ïã§Ìå®`);
                    }
                } catch (error) {
                    this.addLog(`‚ùå Î°úÎ¥á ${robotId} Î¶¨ÏÖã Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            applySettings() {
                const settings = {
                    seed: parseInt(this.seedInput?.value) || 12345,
                    interval: parseInt(this.intervalInput?.value) || 10,
                    strict_mode: this.strictMode?.value === 'true',
                    normalized_mode: this.normalizedMode?.value === 'true'
                };
                
                this.addLog(`‚öôÔ∏è ÏÑ§Ï†ï Ï†ÅÏö©: ${JSON.stringify(settings)}`, 'info');
                
                // ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ Ïû¨ÏãúÏûë (ÏÑ§Ï†ï Ï†ÅÏö©)
                if (confirm('ÏÑ§Ï†ïÏùÑ Ï†ÅÏö©ÌïòÎ†§Î©¥ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞Î•º Ïû¨ÏãúÏûëÌï¥Ïïº Ìï©ÎãàÎã§. Í≥ÑÏÜçÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                    this.restartSimulatorWithSettings(settings);
                }
            }

            resetSettings() {
                if (this.seedInput) this.seedInput.value = '12345';
                if (this.intervalInput) this.intervalInput.value = '10';
                if (this.strictMode) this.strictMode.value = 'false';
                if (this.normalizedMode) this.normalizedMode.value = 'false';
                
                this.addLog(`üîÑ ÏÑ§Ï†ïÏù¥ Í∏∞Î≥∏Í∞íÏúºÎ°ú Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§`, 'info');
            }

            async restartSimulatorWithSettings(settings) {
                this.showLoading(true);
                try {
                    // Î®ºÏ†Ä Ï†ïÏßÄ
                    await fetch(`${this.apiUrl}/api/stop`, { method: 'POST' });
                    
                    // Ïû†Ïãú ÎåÄÍ∏∞
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    // ÏÉà ÏÑ§Ï†ïÏúºÎ°ú ÏãúÏûë
                    const response = await fetch(`${this.apiUrl}/api/start`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(settings)
                    });
                    
                    const result = await response.json();
                    
                    if (response.ok) {
                        this.addLog(`‚úÖ ÏÉà ÏÑ§Ï†ïÏúºÎ°ú ÏãúÎÆ¨Î†àÏù¥ÌÑ∞ Ïû¨ÏãúÏûë ÏôÑÎ£å`, 'success');
                    } else {
                        throw new Error(result.error || 'Ïû¨ÏãúÏûë Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ùå ÏÑ§Ï†ï Ï†ÅÏö© Ïû¨ÏãúÏûë Ïã§Ìå®: ${error.message}`, 'error');
                } finally {
                    this.showLoading(false);
                }
            }

            updateElement(element, value) {
                if (element && element.textContent !== value) {
                    element.textContent = value;
                }
            }

            showLoading(show) {
                if (this.loading) {
                    this.loading.style.display = show ? 'block' : 'none';
                }
            }

            addLog(message, type = 'info') {
                if (!this.logContainer) return;
                
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = `log-entry log-${type}`;
                logEntry.textContent = `[${timestamp}] ${message}`;
                
                this.logContainer.appendChild(logEntry);
                this.logContainer.scrollTop = this.logContainer.scrollHeight;
                
                // Î°úÍ∑∏ Ïàò Ï†úÌïú (ÏµúÎåÄ 50Í∞ú)
                const logs = this.logContainer.children;
                if (logs.length > 50) {
                    this.logContainer.removeChild(logs[0]);
                }
            }

            // MongoDB Í¥ÄÎ†® Î©îÏÑúÎìúÎì§
            async loadMongoConfig() {
                try {
                    const response = await fetch(`${this.apiUrl}/api/mongodb/config`);
                    const result = await response.json();
                    
                    if (result.success) {
                        const config = result.config;
                        document.getElementById('mongoConnectionString').value = config.connection_string || 'mongodb://localhost:27017/';
                        document.getElementById('mongoDatabaseName').value = config.database_name || 'robot_data';
                        document.getElementById('mongoCollectionName').value = config.collection_name || 'robot_missions';
                        
                        this.addLog('üìã MongoDB ÏÑ§Ï†ïÏùÑ Î∂àÎü¨ÏôîÏäµÎãàÎã§', 'success');
                        this.checkMongoConnectionStatus();
                    } else {
                        throw new Error(result.error || 'ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ùå MongoDB ÏÑ§Ï†ï Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®: ${error.message}`, 'error');
                }
            }

            async saveMongoConfig() {
                const connectionString = document.getElementById('mongoConnectionString').value;
                const databaseName = document.getElementById('mongoDatabaseName').value;
                const collectionName = document.getElementById('mongoCollectionName').value;
                
                if (!connectionString || !databaseName || !collectionName) {
                    alert('Î™®Îì† ÌïÑÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                    return;
                }
                
                try {
                    const response = await fetch(`${this.apiUrl}/api/mongodb/config`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            connection_string: connectionString,
                            database_name: databaseName,
                            collection_name: collectionName
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        this.addLog('‚úÖ MongoDB ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§', 'success');
                        this.showMongoTestResult(result.message, 'success');
                        this.checkMongoConnectionStatus();
                    } else {
                        throw new Error(result.error || 'ÏÑ§Ï†ï Ï†ÄÏû• Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ùå MongoDB ÏÑ§Ï†ï Ï†ÄÏû• Ïã§Ìå®: ${error.message}`, 'error');
                    this.showMongoTestResult(`Ï†ÄÏû• Ïã§Ìå®: ${error.message}`, 'error');
                }
            }

            async testMongoConnection() {
                const connectionString = document.getElementById('mongoConnectionString').value;
                const databaseName = document.getElementById('mongoDatabaseName').value;
                
                if (!connectionString || !databaseName) {
                    alert('Ïó∞Í≤∞ Î¨∏ÏûêÏó¥Í≥º Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Î™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî!');
                    return;
                }
                
                this.updateConnectionStatus('testing', 'üîÑ Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ï§ë...');
                
                try {
                    const response = await fetch(`${this.apiUrl}/api/mongodb/test`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            connection_string: connectionString,
                            database_name: databaseName
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        this.addLog(`‚úÖ MongoDB Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ ÏÑ±Í≥µ`, 'success');
                        this.updateConnectionStatus('connected', `üü¢ ${result.message}`);
                        
                        let testMessage = `${result.message}\\n`;
                        testMessage += `Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§: ${result.database_name}\\n`;
                        testMessage += `ÏÑúÎ≤Ñ Î≤ÑÏ†Ñ: ${result.server_version || 'Unknown'}\\n`;
                        testMessage += `Ïª¨Î†âÏÖò Ïàò: ${result.collections ? result.collections.length : 0}`;
                        
                        this.showMongoTestResult(testMessage, 'success');
                    } else {
                        throw new Error(result.message || result.error || 'Ïó∞Í≤∞ Ïã§Ìå®');
                    }
                } catch (error) {
                    this.addLog(`‚ùå MongoDB Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ Ïã§Ìå®: ${error.message}`, 'error');
                    this.updateConnectionStatus('disconnected', 'üî¥ Ïó∞Í≤∞ Ïã§Ìå®');
                    this.showMongoTestResult(`Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, 'error');
                }
            }

            updateConnectionStatus(status, text) {
                const statusElement = document.getElementById('mongoConnectionStatus');
                const textElement = document.getElementById('mongoStatusText');
                
                if (statusElement) {
                    statusElement.className = `connection-status ${status}`;
                }
                
                if (textElement) {
                    textElement.textContent = text;
                }
            }

            showMongoTestResult(message, type) {
                const resultElement = document.getElementById('mongoTestResult');
                const contentElement = document.getElementById('mongoTestContent');
                
                if (resultElement && contentElement) {
                    contentElement.innerHTML = message.replace(/\\n/g, '<br>');
                    resultElement.className = `mongo-test-result ${type}`;
                    resultElement.style.display = 'block';
                    
                    // 5Ï¥à ÌõÑ ÏûêÎèôÏúºÎ°ú Ïà®Í∏∞Í∏∞
                    setTimeout(() => {
                        resultElement.style.display = 'none';
                    }, 5000);
                }
            }

            async checkMongoConnectionStatus() {
                try {
                    const response = await fetch(`${this.apiUrl}/api/mongodb/health`);
                    const result = await response.json();
                    
                    if (result.status === 'healthy') {
                        this.updateConnectionStatus('connected', 'üü¢ Ïó∞Í≤∞Îê®');
                    } else {
                        this.updateConnectionStatus('disconnected', 'üî¥ Ïó∞Í≤∞ ÏïàÎê®');
                    }
                } catch (error) {
                    this.updateConnectionStatus('disconnected', 'üî¥ Ïó∞Í≤∞ ÌôïÏù∏ Ïã§Ìå®');
                }
            }
        }

        // ÎåÄÏãúÎ≥¥Îìú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', () => {
            window.dashboard = new OperationalDashboard();
            // MongoDB ÏÑ§Ï†ï ÏûêÎèô Î∂àÎü¨Ïò§Í∏∞
            setTimeout(() => {
                window.dashboard.loadMongoConfig();
            }, 1000);
        });
    </script>
</body>
</html>
